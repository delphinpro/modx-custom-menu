/*! For license information please see index.bundle.js.LICENSE.txt */
(()=>{var t={165:()=>{Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),i=n.length>>>0,s=arguments[1],r=0;r<i;r++)if(e=n[r],t.call(s,e,r,n))return r;return-1})}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var r=e[i]={exports:{}};return t[i](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";n(165);const t=Vue;var e=n.n(t);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=APP.moduleUrl+"&action=",l=function(t){return o+t},c={credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"},method:"POST",body:null};function u(t){if(t.status>=200&&t.status<300)return t;var e=new Error(t.statusText);throw e.response=t,e}function d(t){return t.json()}function m(t,e,n){if(n=n||c,null!==(e=e||null)&&!(e instanceof FormData)){if("object"!==a(e))throw new Error("Http(): Invalid parameter, FormData or Map expected");var i=new FormData;for(var r in e)e.hasOwnProperty(r)&&i.append(r,e[r]);e=i}var o=s(s({},n),{},{body:e});if(!t)throw new Error("Http(): Invalid url (should not be empty)");return fetch(t,o).then(u).then(d).then((function(t){if(console.log("RESPONSE:",t),void 0===t.status)return t;if(!0===t.status)return t;var e=new Error(t.message||"Server response isn't OK");throw e.response=t,e}))}const p=m;var f,v={state:{err:[],view:null,menus:[],editingMenu:null},addError:function(t){var e=this;clearTimeout(f),this.state.err.push(t),f=setTimeout((function(){return e.clearErrors()}),1e4)},clearErrors:function(){this.state.err=[]},setView:function(t){this.state.view=t},showMenuList:function(){this.setView("MenuList"),this.state.editingMenu=null},showMenuItems:function(t,e){this.state.editingMenu=this.state.menus.slice(e,e+1)[0],this.setView("ItemList")},setMenuList:function(t){this.state.menus=t},delMenuListItem:function(t){return this.state.menus.splice(t,1)},getMenu:function(t){var e=this.state.menus.findIndex((function(e){return e.id===t})),n=this.state.menus.slice(e,e+1);return n.length?n[0]:null}},h={install:function(t){Object.defineProperty(t.prototype,"$store",{get:function(){return this.$root.$data.store}}),Object.defineProperty(t.prototype,"$state",{get:function(){return this.$root.$data.store.state}})}};function _(t,e,n,i,s,r,a,o){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),i&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),a?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=l):s&&(l=o?function(){s.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:s),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(t,e){return l.call(e),u(t,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:t,options:c}}var b=_({props:{menu:{type:Object}},data:function(){return{menuDef:{id:null,name:null,title:""}}},computed:{buttonSaveDisabled:function(){return!this.menuDef.name||""===this.menuDef.name.trim()||""===this.menuDef.title.trim()},captionForm:function(){return this.menuDef.id?"Редактирование меню":"Новое меню"}},created:function(){this.menuDef={id:this.menu.id,name:this.menu.name,title:this.menu.title}},methods:{menuSave:function(){this.$emit("save",this.menuDef)},menuCancel:function(){this.$emit("cancel")}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("fieldset",[n("legend",[t._v(t._s(t.captionForm))]),t._v(" "),n("div",{staticClass:"form-group"},[n("table",{staticClass:"table-params"},[n("tbody",[n("tr",[t._m(0),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.menuDef.id,expression:"menuDef.id",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"text",readonly:""},domProps:{value:t.menuDef.id},on:{input:function(e){e.target.composing||t.$set(t.menuDef,"id",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),t._v(" "),n("tr",[t._m(1),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.menuDef.name,expression:"menuDef.name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.menuDef.name},on:{input:function(e){e.target.composing||t.$set(t.menuDef,"name",e.target.value)}}})])]),t._v(" "),n("tr",[t._m(2),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.menuDef.title,expression:"menuDef.title"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.menuDef.title},on:{input:function(e){e.target.composing||t.$set(t.menuDef,"title",e.target.value)}}})])])])])]),t._v(" "),n("div",{staticClass:"form-group"},[n("div",{staticClass:"btn-group"},[n("button",{staticClass:"btn btn-success",attrs:{disabled:t.buttonSaveDisabled},on:{click:function(e){return e.preventDefault(),t.menuSave.apply(null,arguments)}}},[t._v("\n                Сохранить\n            ")]),t._v(" "),n("button",{staticClass:"btn btn-secondary",on:{click:function(e){return e.preventDefault(),t.menuCancel.apply(null,arguments)}}},[t._v("Отмена")])])])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("span",[t._v("MenuID")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("span",[t._v("Имя меню *")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("span",[t._v("Название меню *")])])}],!1,null,null,null);const y=_({components:{MenuEdit:b.exports},props:{},data:function(){return{isEditing:!1,editing:null}},methods:{menuCreate:function(){this.isEditing=!0,this.editing={id:null,name:null,title:""}},menuEdit:function(t,e){console.log("menuEdit",t,e),this.editing=this.$state.menus.slice(e,e+1)[0],this.isEditing=!0},menuSave:function(t){var e=this;console.log("menuSave",t),t.name?t.title?m(l("menuSave"),t).then((function(n){if(t.id){var i=e.$state.menus.findIndex((function(e){return e.id===t.id}));e.$state.menus.splice(i,1,n.payload.menu)}else e.$state.menus.push(n.payload.menu);e.isEditing=!1,e.editing=null})).catch(this.$defaultError):this.$store.addError("Введите название меню"):this.$store.addError("Введите имя меню")},menuCancel:function(){this.isEditing=!1,this.editing=null},menuDelete:function(t,e){var n=this;confirm("Меню будет удалено!")&&m(l("menuDelete"),{id:t}).then((function(t){n.$store.delMenuListItem(e)})).catch(this.$defaultError)},showItems:function(t,e){this.$store.showMenuItems(t,e)}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"sectionBody"},[n("div",{staticClass:"dynamic-tab-pane-control tab-pane",attrs:{id:"documentPane"}},[n("div",{staticClass:"tab-row-container"},[n("div",{staticClass:"tab-row"},[n("h2",{staticClass:"tab selected"},[n("span",[t._v("Список меню")]),t._v(" "),n("small",[t._v("("+t._s(t.$state.menus.length)+")")])])])]),t._v(" "),n("div",{staticClass:"tab-page"},[t.isEditing?t._e():n("div",[t.$state.menus.length?n("div",{staticClass:"form-group"},[n("div",{staticClass:"menu-list"},[t._m(0),t._v(" "),t._l(t.$state.menus,(function(e,i){return n("div",{key:e.id,staticClass:"menu-list__row"},[n("div",{staticClass:"menu-list__cell _id"},[n("code",[t._v(t._s(e.id))])]),t._v(" "),n("div",{staticClass:"menu-list__cell _name"},[t._v(t._s(e.name))]),t._v(" "),n("div",{staticClass:"menu-list__cell"},[n("button",{staticClass:"btn btn-link",attrs:{disabled:t.isEditing},on:{click:function(n){return n.preventDefault(),t.showItems(e.id,i)}}},[t._v(t._s(e.title)+"\n                                ")])]),t._v(" "),n("div",{staticClass:"menu-list__cell _actions"},[n("div",{staticClass:"btn-group"},[n("button",{staticClass:"btn btn-secondary btn-sm",attrs:{disabled:t.isEditing},on:{click:function(n){return n.preventDefault(),t.menuEdit(e.id,i)}}},[t._v("Изменить\n                                    ")]),t._v(" "),n("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{disabled:t.isEditing},on:{click:function(n){return n.preventDefault(),t.menuDelete(e.id,i)}}},[t._v("Удалить меню\n                                    ")])])])])}))],2)]):n("div",{staticClass:"alert alert-warning"},[t._v("Меню не создано")])]),t._v(" "),t.isEditing?n("MenuEdit",{attrs:{menu:t.editing},on:{cancel:t.menuCancel,save:t.menuSave}}):n("p",[n("button",{staticClass:"btn btn-primary",on:{click:function(e){return e.preventDefault(),t.menuCreate.apply(null,arguments)}}},[t._v("Новое меню")])])],1)])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"menu-list__row"},[n("div",{staticClass:"menu-list__cell _head _id"},[t._v("ID")]),t._v(" "),n("div",{staticClass:"menu-list__cell _head _name"},[t._v("Имя")]),t._v(" "),n("div",{staticClass:"menu-list__cell _head"},[t._v("Название")]),t._v(" "),n("div",{staticClass:"menu-list__cell _head"})])}],!1,null,null,null).exports,g=_({props:{title:{type:String,default:"Title"},width:{type:String,default:"600px"},tree:{type:Array,default:function(){return[]}},currentNode:{type:Object,default:null}},data:function(){return{ready:!1}},computed:{styles:function(){return{width:this.width}}},mounted:function(){this.ready=!0}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"cm-fade"}},[n("div",{staticClass:"cm-modal-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.$emit("close")}}},[n("transition",{attrs:{name:"cm-modal"}},[t.ready?n("div",{staticClass:"cm-modal",style:t.styles},[n("div",{staticClass:"cm-modal__close close",on:{click:function(e){return e.preventDefault(),t.$emit("close")}}},[t._v("×")]),t._v(" "),n("div",{staticClass:"cm-modal__header"},[n("i",{staticClass:"fa fa-info"}),t._v(t._s(t.title)+"\n                ")]),t._v(" "),n("div",{staticClass:"cm-modal__body"},[t.tree.length?n("div",{staticClass:"treeRoot"},t._l(t.tree,(function(e){return n("DocSelectorNode",{key:e.id,attrs:{node:e,"current-node":t.currentNode},on:{picked:function(e){return t.$emit("picked",e)}}})})),1):t._e()])]):t._e()])],1)])}),[],!1,null,null,null).exports;function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function $(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var E,I=_({components:{DocSelector:g},props:{menu:{type:Object,default:null},menuItem:{type:Object,default:null},menuItems:{type:Array,default:null}},data:function(){return{item:{id:null,parentId:null,menuId:null,orderIndex:0,isHide:0,replaced:0,docId:null,docTitle:"",title:"",url:"",alias:""},parentSelectorShow:!1}},computed:{correctItem:function(){var t=this.item.docTitle&&this.item.docTitle.trim()||this.item.title&&this.item.title.trim();return this.item.menuId>0&&t},captionForm:function(){return this.item.id?"Редактирование пункта меню":"Добавление пункта меню"}},created:function(){console.log("ItemEdit created"),null===this.menuItem?this.item.menuId=this.menu.id:this.item=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){$(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},this.menuItem)},methods:{loadResource:function(){var t=this;this.item.docId?(clearTimeout(E),E=setTimeout((function(){t.$store.clearErrors(),m(l("getResource"),{docId:t.item.docId}).then((function(e){t.item.docTitle=e.payload.resource.docTitle,t.item.url=e.payload.resource.url,t.item.alias=e.payload.resource.alias})).catch((function(e){t.item.docTitle=null,t.item.url=null,t.item.alias=null,t.$defaultError(e)}))}),400)):(this.item.docId=null,this.item.docTitle="",this.item.url="",this.item.alias="")},itemSave:function(){var t=this;this.$store.clearErrors(),this.item.docId||(this.item.docId=null),m(l("itemSave"),this.item).then((function(e){t.$emit("itemSave",e.payload.item)})).catch(this.$defaultError)},itemCancel:function(){this.$emit("cancel")},onPicked:function(t){this.item.parentId=t.id,this.parentSelectorShow=!1},resetParent:function(){this.item.parentId=0,this.itemSave()},clearDocId:function(){this.item.docId=null}},watch:{"item.docId":function(t){console.log(t),t||(this.item.replaced=0,this.item.docTitle="",this.item.alias="",this.item.url="")}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("fieldset",[n("legend",[t._v(t._s(t.captionForm))]),t._v(" "),n("div",{staticClass:"form-group"},[n("table",{staticClass:"table-params"},[n("tbody",[n("tr",[t._m(0),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.item.title,expression:"item.title"}],staticClass:"form-control",attrs:{type:"text",placeholder:t.item.docTitle},domProps:{value:t.item.title},on:{input:function(e){e.target.composing||t.$set(t.item,"title",e.target.value)}}})])]),t._v(" "),n("tr",[t._m(1),t._v(" "),n("td",[n("div",{staticClass:"flex"},[n("button",{staticClass:"btn btn-secondary",on:{click:function(e){t.parentSelectorShow=!0}}},[t._v("Выбрать…")]),t._v(" "),n("button",{staticClass:"btn btn-secondary",on:{click:t.resetParent}},[t._v("Сбросить")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.item.parentId,expression:"item.parentId"}],staticClass:"form-control",attrs:{type:"text",readonly:""},domProps:{value:t.item.parentId},on:{input:function(e){e.target.composing||t.$set(t.item,"parentId",e.target.value)}}})])])]),t._v(" "),n("tr",[t._m(2),t._v(" "),n("td",[n("div",{staticClass:"flex"},[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.item.docId,expression:"item.docId",modifiers:{number:!0}}],staticClass:"form-control",staticStyle:{width:"60px","text-align":"center"},attrs:{type:"text",placeholder:"[~id~]"},domProps:{value:t.item.docId},on:{input:[function(e){e.target.composing||t.$set(t.item,"docId",t._n(e.target.value))},t.loadResource],blur:function(e){return t.$forceUpdate()}}}),t._v(" "),n("button",{staticClass:"btn btn-secondary",on:{click:t.clearDocId}},[t._v("Очистить")]),t._v(" "),n("input",{staticClass:"form-control",attrs:{type:"text",readonly:"",placeholder:""},domProps:{value:t.item.docTitle}}),t._v(" "),n("button",{staticClass:"btn btn-secondary",attrs:{disabled:""}},[t._v("Выбрать…")])])])]),t._v(" "),t.item.replaced?t._e():n("tr",[t._m(3),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.item.url,expression:"item.url"}],staticClass:"form-control",attrs:{type:"text",placeholder:""},domProps:{value:t.item.url},on:{input:function(e){e.target.composing||t.$set(t.item,"url",e.target.value)}}})])]),t._v(" "),t.item.docId&&t.item.docTitle?n("tr",[t._m(4),t._v(" "),n("td",[n("div",{staticClass:"flex"},[n("select",{staticClass:"form-control",staticStyle:{"max-width":"60px"},on:{change:function(e){t.item.replaced=+e.target.value}}},[n("option",{key:0,domProps:{value:0,selected:0===t.item.replaced}},[t._v("Нет")]),t._v(" "),n("option",{key:1,domProps:{value:1,selected:1===t.item.replaced}},[t._v("Да")])]),t._v(" "),n("span",{staticClass:"text-muted",staticStyle:{"padding-left":"1rem","line-height":"15px"}},[t._v("\n              Замещаемый элемент непосредственно не отображается в меню.\n              Он замещает себя ссылками на дочерние страницы выбранного ресурса.\n            ")])])])]):t._e(),t._v(" "),n("tr",[t._m(5),t._v(" "),n("td",[n("div",{staticClass:"flex"},[n("select",{staticClass:"form-control",staticStyle:{"max-width":"60px"},on:{change:function(e){t.item.isHide=+e.target.value}}},[n("option",{key:0,domProps:{value:0,selected:0===t.item.isHide}},[t._v("Нет")]),t._v(" "),n("option",{key:1,domProps:{value:1,selected:1===t.item.isHide}},[t._v("Да")])])])])]),t._v(" "),n("tr",[t._m(6),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.item.menuId,expression:"item.menuId"}],staticClass:"form-control",staticStyle:{width:"60px"},attrs:{type:"text",readonly:"",placeholder:""},domProps:{value:t.item.menuId},on:{input:function(e){e.target.composing||t.$set(t.item,"menuId",e.target.value)}}}),t._v(" "),n("span",{staticClass:"form-control-static"},[t._v("/")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.item.id,expression:"item.id"}],staticClass:"form-control",staticStyle:{width:"60px"},attrs:{type:"text",readonly:"",placeholder:""},domProps:{value:t.item.id},on:{input:function(e){e.target.composing||t.$set(t.item,"id",e.target.value)}}})])]),t._v(" "),t.item.replaced?t._e():n("tr",[t._m(7),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.item.alias,expression:"item.alias"}],staticClass:"form-control",attrs:{type:"text",readonly:"",placeholder:""},domProps:{value:t.item.alias},on:{input:function(e){e.target.composing||t.$set(t.item,"alias",e.target.value)}}})])])])])]),t._v(" "),n("div",{staticClass:"form-group d-flex"},[n("div",{staticClass:"btn-group"},[n("button",{staticClass:"btn",class:{"btn-success":t.correctItem,"btn-secondary":!t.correctItem},attrs:{disabled:!t.correctItem},on:{click:function(e){return e.preventDefault(),t.itemSave.apply(null,arguments)}}},[t._v("Сохранить\n      ")]),t._v(" "),n("button",{staticClass:"btn btn-secondary",on:{click:function(e){return e.preventDefault(),t.itemCancel.apply(null,arguments)}}},[t._v("Отмена")])])]),t._v(" "),t.parentSelectorShow?n("DocSelector",{attrs:{width:"700px",title:"Выберите родительский пункт для редактируемого",tree:t.menuItems,"current-node":t.item},on:{picked:t.onPicked,close:function(e){t.parentSelectorShow=!1}}}):t._e()],1)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("span",[t._v("Название пункта")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("span",[t._v("Родитель")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("span",[t._v("Ресурс")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("span",[t._v("Ссылка")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("span",[t._v("Замещаемый элемент")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("span",[t._v("Скрыть этот пункт")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("span",[t._v("MenuID / ItemID")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("span",[t._v("Alias")])])}],!1,null,null,null);const w=_({components:{ItemEdit:I.exports},props:{menu:{type:Object,default:null}},data:function(){return{isEditing:!1,editingItem:null,items:[]}},created:function(){this.itemList(this.menu.id)},methods:{backToMenuList:function(){this.$store.setView("MenuList")},itemList:function(t){var e=this;this.editingItem=null,this.isEditing=!1,m(l("itemList"),{menuId:t}).then((function(t){e.items=t.payload.itemsTree})).catch(this.$defaultError)},itemCreate:function(){this.editingItem=null,this.isEditing=!0},itemCancel:function(){this.isEditing=!1},itemEdit:function(t){this.editingItem=t,this.isEditing=!0},itemOrder:function(t,e){var n=this;m(l("itemOrder"),{id:t.id,parentId:t.parentId,menuId:t.menuId,dir:e}).then((function(e){n.itemList(t.menuId)})).catch(this.$defaultError)},itemDelete:function(t){var e=this;confirm("Пункт меню будет удалён со всеми подпунктами!")&&m(l("itemDelete"),{id:t.id}).then((function(n){e.itemList(t.menuId)})).catch(this.$defaultError)},onItemSave:function(t){this.itemList(t.menuId)}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"sectionBody"},[n("div",{staticClass:"dynamic-tab-pane-control tab-pane",attrs:{id:"documentPane"}},[n("div",{staticClass:"tab-row-container"},[n("div",{staticClass:"tab-row"},[n("button",{staticClass:"tab",attrs:{disabled:t.isEditing},on:{click:function(e){return e.preventDefault(),t.backToMenuList.apply(null,arguments)}}},[n("span",[t._v("Список меню")]),t._v(" "),n("small",[t._v("("+t._s(t.$state.menus.length)+")")])]),t._v(" "),t._m(0)])]),t._v(" "),n("div",{staticClass:"tab-page"},[n("h4",{staticStyle:{"margin-bottom":"1rem"}},[n("span",[t._v(t._s(t.menu.title))]),t._v(" "),n("small",[t._v("("+t._s(t.menu.name)+", "+t._s(t.menu.id)+")")])]),t._v(" "),t.isEditing?t._e():n("div",{staticClass:"form-group"},[t.items.length?n("div",{staticClass:"treeRoot"},t._l(t.items,(function(e,i){return n("TreeNode",{key:e.id,attrs:{node:e,index:i,"parent-len":t.items.length,disabled:t.isEditing},on:{change:t.itemEdit,order:t.itemOrder,delete:t.itemDelete}})})),1):n("div",{staticClass:"alert alert-warning"},[t._v("Пункты не созданы")])]),t._v(" "),t.isEditing?n("ItemEdit",{attrs:{menu:t.menu,"menu-item":t.editingItem,"menu-items":t.items},on:{cancel:t.itemCancel,itemSave:t.onItemSave}}):n("div",[n("div",{staticClass:"form-group"},[n("button",{staticClass:"btn btn-primary",on:{click:function(e){return e.preventDefault(),t.itemCreate.apply(null,arguments)}}},[t._v("Добавить пункт")])]),t._v(" "),n("div",{staticClass:"form-group"},[n("button",{staticClass:"btn btn-secondary",on:{click:function(e){return e.preventDefault(),t.backToMenuList.apply(null,arguments)}}},[t._v("\n                            Завершить редактирование\n                        ")])])])],1)])])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("h2",{staticClass:"tab selected"},[n("span",[t._v("Редактировать пункты")])])}],!1,null,null,null).exports,x=_({props:{node:{type:Object},index:{type:Number},indent:{type:Number,default:0},parentLen:{type:Number,default:0},disabled:{type:Boolean,default:!1}},data:function(){return{}},computed:{icon:function(){return{"fa-file-o":!this.node.children.length,"fa-folder-open":this.node.children.length&&!this.node.replaced,"fa-exchange":this.node.replaced}},indentArr:function(){for(var t=[],e=0;e<this.indent;e++)t.push(1);return t}},methods:{onOrder:function(t,e){this.$emit("order",t,e)}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a",{staticClass:"node",class:{unpublished:1===t.node.isHide}},[n("span",{staticClass:"indent"},t._l(t.indentArr,(function(t){return n("i")})),0),t._v(" "),n("span",{staticClass:"icon",on:{click:function(e){return e.preventDefault(),t.$emit("change",t.node)}}},[n("i",{staticClass:"fa",class:t.icon})]),t._v(" "),n("span",{staticClass:"title",on:{click:function(e){return e.preventDefault(),t.$emit("change",t.node)}}},[t.node.replaced?t._e():n("span",[t._v(t._s(t.node.title))]),t._v(" "),(t.node.title!==t.node.docTitle||t.node.replaced)&&t.node.docTitle?n("span",{staticClass:"text-muted"},[t._v("("+t._s(t.node.docTitle)+")")]):t._e()]),t._v(" "),n("div",{staticClass:"btn-group"},[n("button",{staticClass:"btn btn-secondary btn-sm",attrs:{disabled:t.disabled||0===t.index},on:{click:function(e){return e.preventDefault(),t.$emit("order",t.node,1)}}},[n("i",{staticClass:"fa fa-arrow-up"})]),t._v(" "),n("button",{staticClass:"btn btn-secondary btn-sm",attrs:{disabled:""}},[t._v(t._s(t.node.orderIndex))]),t._v(" "),n("button",{staticClass:"btn btn-secondary btn-sm",attrs:{disabled:t.disabled||t.index>=t.parentLen-1},on:{click:function(e){return e.preventDefault(),t.$emit("order",t.node,2)}}},[n("i",{staticClass:"fa fa-arrow-down"})]),t._v(" "),n("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{disabled:t.disabled},on:{click:function(e){return e.preventDefault(),t.$emit("delete",t.node)}}},[t._v("Удалить пункт\n            ")])])]),t._v(" "),t.node.children.length?n("div",t._l(t.node.children,(function(e,i){return n("TreeNode",{key:e.id,attrs:{node:e,index:i,indent:t.indent+1,"parent-len":t.node.children.length,disabled:t.disabled},on:{change:function(e){return t.$emit("change",e)},order:t.onOrder,delete:function(e){return t.$emit("delete",e)}}})})),1):t._e()])}),[],!1,null,null,null).exports,D=_({props:{node:{type:Object},indent:{type:Number,default:0},currentNode:{type:Object,default:null}},data:function(){return{}},computed:{iconClass:function(){return{"fa-file-o":!this.node.children.length,"fa-folder-open":this.node.children.length&&!this.node.replaced,"fa-exchange":this.node.replaced}},nodeClasses:function(){return{unpublished:1===this.node.isHide,hidemenu:this.disabledNode}},disabledNode:function(){return this.node.id===this.currentNode.id||this.node.id===this.currentNode.parentId||1===this.node.replaced},indentArr:function(){for(var t=[],e=0;e<this.indent;e++)t.push(1);return t}},methods:{onOrder:function(t,e){this.$emit("order",t,e)}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a",{staticClass:"node",class:t.nodeClasses},[n("span",{staticClass:"indent"},t._l(t.indentArr,(function(t){return n("i")})),0),t._v(" "),n("span",{staticClass:"icon"},[n("i",{staticClass:"fa",class:t.iconClass})]),t._v(" "),n("span",{staticClass:"title",on:{click:function(e){e.preventDefault(),!t.disabledNode&&t.$emit("picked",t.node)}}},[t.node.replaced?n("span",[t._v(t._s(t.node.docTitle))]):n("span",[t._v(t._s(t.node.title))])])]),t._v(" "),t.node.children.length?n("div",t._l(t.node.children,(function(e,i){return n("DocSelectorNode",{key:e.id,attrs:{node:e,indent:t.indent+1,"current-node":t.currentNode},on:{picked:function(e){return t.$emit("picked",e)}}})})),1):t._e()])}),[],!1,null,null,null).exports;console.clear(),e().use(h),e().use({install:function(t){Object.defineProperty(t.prototype,"$defaultError",{get:function(){return function(t){t.response?v.addError(t.response.message):(v.addError(t.message),console.error(t))}}})}}),e().component("TreeNode",x),e().component("DocSelectorNode",D);var O=["","lightness","light","dark","darkness"];O[parseInt(localStorage.MODX_themeMode)]&&(document.body.classList.remove("lightness"),document.body.classList.remove("light"),document.body.classList.remove("dark"),document.body.classList.remove("darkness"),document.body.classList.add(O[parseInt(localStorage.MODX_themeMode)])),new(e())({el:"#app",components:{MenuList:y,ItemList:w,DocSelector:g},data:{store:v,docSelectorShow:!0},created:function(){var t=this;console.log("App created"),p(l("menuList")).then((function(e){t.$store.setMenuList(e.payload.menuList),t.$store.showMenuList()})).catch(this.$defaultError)},mounted:function(){var t=this;this.$nextTick((function(){return t.$el.classList.add("AppMounted")}))},methods:{}})})()})();