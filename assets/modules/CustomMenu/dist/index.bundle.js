(()=>{"use strict";var t={n:e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},d:(e,n)=>{for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const e=Vue;var n=t.n(e);const i=window.APP.moduleUrl+"&action=",s=t=>i+t,a={credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"},method:"POST",body:null};function r(t){if(t.status>=200&&t.status<300)return t;{let e=new Error(t.statusText);throw e.response=t,e}}function l(t){return t.json()}function o(t,e,n){if(n=n||a,null!==(e=e||null)&&!(e instanceof FormData)){if("object"!=typeof e)throw new Error("Http(): Invalid parameter, FormData or Map expected");{let t=new FormData;for(let n in e)e.hasOwnProperty(n)&&t.append(n,e[n]);e=t}}let i={...n,body:e};if(!t)throw new Error("Http(): Invalid url (should not be empty)");return fetch(t,i).then(r).then(l).then((t=>{if(console.log("RESPONSE:",t),void 0===t.status)return t;if(!0===t.status)return t;let e=new Error(t.message||"Server response isn't OK");throw e.response=t,e}))}const d=o;let c;const u={state:{err:[],view:null,menus:[],editingMenu:null},addError(t){clearTimeout(c),this.state.err.push(t),c=setTimeout((()=>this.clearErrors()),1e4)},clearErrors(){this.state.err=[]},setView(t){this.state.view=t},showMenuList(){this.setView("MenuList"),this.state.editingMenu=null},showMenuItems(t,e){this.state.editingMenu=this.state.menus.slice(e,e+1)[0],this.setView("ItemList")},setMenuList(t){this.state.menus=t},delMenuListItem(t){return this.state.menus.splice(t,1)},getMenu(t){let e=this.state.menus.findIndex((e=>e.id===t)),n=this.state.menus.slice(e,e+1);return n.length?n[0]:null}},m={install(t){Object.defineProperty(t.prototype,"$store",{get(){return this.$root.$data.store}}),Object.defineProperty(t.prototype,"$state",{get(){return this.$root.$data.store.state}})}};var p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"sectionBody"},[e("div",{staticClass:"dynamic-tab-pane-control tab-pane",attrs:{id:"documentPane"}},[e("div",{staticClass:"tab-row-container"},[e("div",{staticClass:"tab-row"},[e("h2",{staticClass:"tab selected"},[e("span",[t._v("Список меню")]),t._v(" "),e("small",[t._v("("+t._s(t.$state.menus.length)+")")])])])]),t._v(" "),e("div",{staticClass:"tab-page"},[t.isEditing?t._e():e("div",[t.$state.menus.length?e("div",{staticClass:"form-group"},[e("div",{staticClass:"menu-list"},[t._m(0),t._v(" "),t._l(t.$state.menus,(function(n,i){return e("div",{key:n.id,staticClass:"menu-list__row"},[e("div",{staticClass:"menu-list__cell _id"},[e("code",[t._v(t._s(n.id))])]),t._v(" "),e("div",{staticClass:"menu-list__cell _name"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"menu-list__cell"},[e("button",{staticClass:"btn btn-link",attrs:{disabled:t.isEditing},on:{click:function(e){return e.preventDefault(),t.showItems(n.id,i)}}},[t._v(t._s(n.title)+"\r\n                                    ")])]),t._v(" "),e("div",{staticClass:"menu-list__cell _actions"},[e("div",{staticClass:"btn-group"},[e("button",{staticClass:"btn btn-secondary btn-sm",attrs:{disabled:t.isEditing},on:{click:function(e){return e.preventDefault(),t.menuEdit(n.id,i)}}},[t._v("Изменить\r\n                                        ")]),t._v(" "),e("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{disabled:t.isEditing},on:{click:function(e){return e.preventDefault(),t.menuDelete(n.id,i)}}},[t._v("Удалить меню\r\n                                        ")])])])])}))],2)]):e("div",{staticClass:"alert alert-warning"},[t._v("Меню не создано")])]),t._v(" "),t.isEditing?e("MenuEdit",{attrs:{menu:t.editing},on:{cancel:t.menuCancel,save:t.menuSave}}):e("p",[e("button",{staticClass:"btn btn-primary",on:{click:function(e){return e.preventDefault(),t.menuCreate.apply(null,arguments)}}},[t._v("Новое меню")])])],1)])])};p._withStripped=!0;var v=function(){var t=this,e=t._self._c;return e("fieldset",[e("legend",[t._v(t._s(t.captionForm))]),t._v(" "),e("div",{staticClass:"form-group"},[e("table",{staticClass:"table-params"},[e("tbody",[e("tr",[t._m(0),t._v(" "),e("td",[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.menuDef.id,expression:"menuDef.id",modifiers:{number:!0}}],staticClass:"form-control",attrs:{readonly:"",type:"text"},domProps:{value:t.menuDef.id},on:{input:function(e){e.target.composing||t.$set(t.menuDef,"id",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),t._v(" "),e("tr",[t._m(1),t._v(" "),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.menuDef.name,expression:"menuDef.name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.menuDef.name},on:{input:function(e){e.target.composing||t.$set(t.menuDef,"name",e.target.value)}}})])]),t._v(" "),e("tr",[t._m(2),t._v(" "),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.menuDef.title,expression:"menuDef.title"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.menuDef.title},on:{input:function(e){e.target.composing||t.$set(t.menuDef,"title",e.target.value)}}})])])])])]),t._v(" "),e("div",{staticClass:"form-group"},[e("div",{staticClass:"btn-group"},[e("button",{staticClass:"btn btn-success",attrs:{disabled:t.buttonSaveDisabled},on:{click:function(e){return e.preventDefault(),t.menuSave.apply(null,arguments)}}},[t._v("\r\n                    Сохранить\r\n                ")]),t._v(" "),e("button",{staticClass:"btn btn-secondary",on:{click:function(e){return e.preventDefault(),t.menuCancel.apply(null,arguments)}}},[t._v("Отмена")])])])])};function h(t,e,n,i,s,a,r,l){var o,d="function"==typeof t?t.options:t;if(e&&(d.render=e,d.staticRenderFns=n,d._compiled=!0),i&&(d.functional=!0),a&&(d._scopeId="data-v-"+a),r?(o=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},d._ssrRegister=o):s&&(o=l?function(){s.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:s),o)if(d.functional){d._injectStyles=o;var c=d.render;d.render=function(t,e){return o.call(e),c(t,e)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,o):[o]}return{exports:t,options:d}}v._withStripped=!0;var _=h({props:{menu:{type:Object}},data:()=>({menuDef:{id:null,name:null,title:""}}),computed:{buttonSaveDisabled(){return!this.menuDef.name||""===this.menuDef.name.trim()||""===this.menuDef.title.trim()},captionForm(){return this.menuDef.id?"Редактирование меню":"Новое меню"}},created(){this.menuDef={id:this.menu.id,name:this.menu.name,title:this.menu.title}},methods:{menuSave(){this.$emit("save",this.menuDef)},menuCancel(){this.$emit("cancel")}}},v,[function(){var t=this._self._c;return t("td",[t("span",[this._v("MenuID")])])},function(){var t=this._self._c;return t("td",[t("span",[this._v("Имя меню *")])])},function(){var t=this._self._c;return t("td",[t("span",[this._v("Название меню *")])])}],!1,null,null,null);const f=h({components:{MenuEdit:_.exports},props:{},data:()=>({isEditing:!1,editing:null}),methods:{menuCreate(){this.isEditing=!0,this.editing={id:null,name:null,title:""}},menuEdit(t,e){console.log("menuEdit",t,e),this.editing=this.$state.menus.slice(e,e+1)[0],this.isEditing=!0},menuSave(t){console.log("menuSave",t),t.name?t.title?o(s("menuSave"),t).then((e=>{if(t.id){let n=this.$state.menus.findIndex((e=>e.id===t.id));this.$state.menus.splice(n,1,e.payload.menu)}else this.$state.menus.push(e.payload.menu);this.isEditing=!1,this.editing=null})).catch(this.$defaultError):this.$store.addError("Введите название меню"):this.$store.addError("Введите имя меню")},menuCancel(){this.isEditing=!1,this.editing=null},menuDelete(t,e){confirm("Меню будет удалено!")&&o(s("menuDelete"),{id:t}).then((t=>{this.$store.delMenuListItem(e)})).catch(this.$defaultError)},showItems(t,e){this.$store.showMenuItems(t,e)}}},p,[function(){var t=this,e=t._self._c;return e("div",{staticClass:"menu-list__row"},[e("div",{staticClass:"menu-list__cell _head _id"},[t._v("ID")]),t._v(" "),e("div",{staticClass:"menu-list__cell _head _name"},[t._v("Имя")]),t._v(" "),e("div",{staticClass:"menu-list__cell _head"},[t._v("Название")]),t._v(" "),e("div",{staticClass:"menu-list__cell _head"})])}],!1,null,null,null).exports;var b=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"sectionBody"},[e("div",{staticClass:"dynamic-tab-pane-control tab-pane",attrs:{id:"documentPane"}},[e("div",{staticClass:"tab-row-container"},[e("div",{staticClass:"tab-row"},[e("button",{staticClass:"tab",attrs:{disabled:t.isEditing},on:{click:function(e){return e.preventDefault(),t.backToMenuList.apply(null,arguments)}}},[e("span",[t._v("Список меню")]),t._v(" "),e("small",[t._v("("+t._s(t.$state.menus.length)+")")])]),t._v(" "),t._m(0)])]),t._v(" "),e("div",{staticClass:"tab-page"},[e("h4",{staticStyle:{"margin-bottom":"1rem"}},[e("span",[t._v(t._s(t.menu.title))]),t._v(" "),e("small",[t._v("("+t._s(t.menu.name)+", "+t._s(t.menu.id)+")")])]),t._v(" "),t.isEditing?t._e():e("div",{staticClass:"form-group"},[t.items.length?e("div",{staticClass:"treeRoot"},t._l(t.items,(function(n,i){return e("TreeNode",{key:n.id,attrs:{disabled:t.isEditing,index:i,node:n,"parent-len":t.items.length},on:{change:t.itemEdit,delete:t.itemDelete,order:t.itemOrder}})})),1):e("div",{staticClass:"alert alert-warning"},[t._v("Пункты не созданы")])]),t._v(" "),t.isEditing?e("ItemEdit",{attrs:{menu:t.menu,"menu-item":t.editingItem,"menu-items":t.items},on:{cancel:t.itemCancel,itemSave:t.onItemSave}}):e("div",[e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-primary",on:{click:function(e){return e.preventDefault(),t.itemCreate.apply(null,arguments)}}},[t._v("Добавить пункт")])]),t._v(" "),e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-secondary",on:{click:function(e){return e.preventDefault(),t.backToMenuList.apply(null,arguments)}}},[t._v("\r\n                                Завершить редактирование\r\n                            ")])])])],1)])])])};b._withStripped=!0;var g=function(){var t=this,e=t._self._c;return e("fieldset",[e("legend",[t._v(t._s(t.captionForm))]),t._v(" "),e("div",{staticClass:"form-group"},[e("table",{staticClass:"table-params"},[e("tbody",[e("tr",[t._m(0),t._v(" "),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.item.title,expression:"item.title"}],staticClass:"form-control",attrs:{placeholder:t.item.docTitle,type:"text"},domProps:{value:t.item.title},on:{input:function(e){e.target.composing||t.$set(t.item,"title",e.target.value)}}})])]),t._v(" "),e("tr",[t._m(1),t._v(" "),e("td",[e("div",{staticClass:"flex"},[e("button",{staticClass:"btn btn-secondary",on:{click:function(e){t.parentSelectorShow=!0}}},[t._v("Выбрать…")]),t._v(" "),e("button",{staticClass:"btn btn-secondary",on:{click:t.resetParent}},[t._v("Сбросить")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.item.parentId,expression:"item.parentId"}],staticClass:"form-control",attrs:{readonly:"",type:"text"},domProps:{value:t.item.parentId},on:{input:function(e){e.target.composing||t.$set(t.item,"parentId",e.target.value)}}})])])]),t._v(" "),e("tr",[t._m(2),t._v(" "),e("td",[e("div",{staticClass:"flex"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.item.docId,expression:"item.docId",modifiers:{number:!0}}],staticClass:"form-control",staticStyle:{width:"60px","text-align":"center"},attrs:{placeholder:"[~id~]",type:"text"},domProps:{value:t.item.docId},on:{input:[function(e){e.target.composing||t.$set(t.item,"docId",t._n(e.target.value))},t.loadResource],blur:function(e){return t.$forceUpdate()}}}),t._v(" "),e("button",{staticClass:"btn btn-secondary",on:{click:t.clearDocId}},[t._v("Очистить")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{placeholder:"",readonly:"",type:"text"},domProps:{value:t.item.docTitle}}),t._v(" "),e("button",{staticClass:"btn btn-secondary",attrs:{disabled:""}},[t._v("Выбрать…")])])])]),t._v(" "),t.item.replaced?t._e():e("tr",[t._m(3),t._v(" "),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.item.url,expression:"item.url"}],staticClass:"form-control",attrs:{placeholder:"",type:"text"},domProps:{value:t.item.url},on:{input:function(e){e.target.composing||t.$set(t.item,"url",e.target.value)}}})])]),t._v(" "),t.item.docId&&t.item.docTitle?e("tr",[t._m(4),t._v(" "),e("td",[e("div",{staticClass:"flex"},[e("select",{staticClass:"form-control",staticStyle:{"max-width":"60px"},on:{change:function(e){t.item.replaced=+e.target.value}}},[e("option",{key:0,domProps:{selected:0===t.item.replaced,value:0}},[t._v("Нет")]),t._v(" "),e("option",{key:1,domProps:{selected:1===t.item.replaced,value:1}},[t._v("Да")])]),t._v(" "),e("span",{staticClass:"text-muted",staticStyle:{"padding-left":"1rem","line-height":"15px"}},[t._v("\n                                    Замещаемый элемент непосредственно не отображается в меню.\n                                    Он замещает себя ссылками на дочерние страницы выбранного ресурса.\n                                ")])])])]):t._e(),t._v(" "),e("tr",[t._m(5),t._v(" "),e("td",[e("div",{staticClass:"flex"},[e("select",{staticClass:"form-control",staticStyle:{"max-width":"60px"},on:{change:function(e){t.item.isHide=+e.target.value}}},[e("option",{key:0,domProps:{selected:0===t.item.isHide,value:0}},[t._v("Нет")]),t._v(" "),e("option",{key:1,domProps:{selected:1===t.item.isHide,value:1}},[t._v("Да")])])])])]),t._v(" "),e("tr",[t._m(6),t._v(" "),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.item.menuId,expression:"item.menuId"}],staticClass:"form-control",staticStyle:{width:"60px"},attrs:{placeholder:"",readonly:"",type:"text"},domProps:{value:t.item.menuId},on:{input:function(e){e.target.composing||t.$set(t.item,"menuId",e.target.value)}}}),t._v(" "),e("span",{staticClass:"form-control-static"},[t._v("/")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.item.id,expression:"item.id"}],staticClass:"form-control",staticStyle:{width:"60px"},attrs:{placeholder:"",readonly:"",type:"text"},domProps:{value:t.item.id},on:{input:function(e){e.target.composing||t.$set(t.item,"id",e.target.value)}}})])]),t._v(" "),t.item.replaced?t._e():e("tr",[t._m(7),t._v(" "),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.item.alias,expression:"item.alias"}],staticClass:"form-control",attrs:{placeholder:"",readonly:"",type:"text"},domProps:{value:t.item.alias},on:{input:function(e){e.target.composing||t.$set(t.item,"alias",e.target.value)}}})])]),t._v(" "),e("tr",[t._m(8),t._v(" "),e("td",[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.item.props,expression:"item.props"}],staticClass:"form-control",attrs:{placeholder:"Валидный JSON",rows:"5"},domProps:{value:t.item.props},on:{input:function(e){e.target.composing||t.$set(t.item,"props",e.target.value)}}})])])])])]),t._v(" "),e("div",{staticClass:"form-group d-flex"},[e("div",{staticClass:"btn-group"},[e("button",{staticClass:"btn",class:{"btn-success":t.correctItem,"btn-secondary":!t.correctItem},attrs:{disabled:!t.correctItem},on:{click:function(e){return e.preventDefault(),t.itemSave.apply(null,arguments)}}},[t._v("Сохранить\n                ")]),t._v(" "),e("button",{staticClass:"btn btn-secondary",on:{click:function(e){return e.preventDefault(),t.itemCancel.apply(null,arguments)}}},[t._v("Отмена")])])]),t._v(" "),t.parentSelectorShow?e("DocSelector",{attrs:{"current-node":t.item,tree:t.menuItems,title:"Выберите родительский пункт для редактируемого",width:"700px"},on:{close:function(e){t.parentSelectorShow=!1},picked:t.onPicked}}):t._e()],1)};g._withStripped=!0;var C=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"cm-fade"}},[e("div",{staticClass:"cm-modal-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.$emit("close")}}},[e("transition",{attrs:{name:"cm-modal"}},[t.ready?e("div",{staticClass:"cm-modal",style:t.styles},[e("div",{staticClass:"cm-modal__close close",on:{click:function(e){return e.preventDefault(),t.$emit("close")}}},[t._v("×")]),t._v(" "),e("div",{staticClass:"cm-modal__header"},[e("i",{staticClass:"fa fa-info"}),t._v(t._s(t.title)+"\r\n                    ")]),t._v(" "),e("div",{staticClass:"cm-modal__body"},[t.tree.length?e("div",{staticClass:"treeRoot"},t._l(t.tree,(function(n){return e("DocSelectorNode",{key:n.id,attrs:{"current-node":t.currentNode,node:n},on:{picked:function(e){return t.$emit("picked",e)}}})})),1):t._e()])]):t._e()])],1)])};C._withStripped=!0;const y=h({props:{title:{type:String,default:"Title"},width:{type:String,default:"600px"},tree:{type:Array,default:()=>[]},currentNode:{type:Object,default:null}},data:()=>({ready:!1}),computed:{styles(){return{width:this.width}}},mounted(){this.ready=!0}},C,[],!1,null,null,null).exports;let I;var w=h({components:{DocSelector:y},props:{menu:{type:Object,default:null},menuItem:{type:Object,default:null},menuItems:{type:Array,default:null}},data:()=>({item:{id:null,parentId:null,menuId:null,orderIndex:0,isHide:0,replaced:0,docId:null,docTitle:"",title:"",url:"",alias:"",props:null},parentSelectorShow:!1}),computed:{correctItem(){let t=this.item.docTitle&&this.item.docTitle.trim()||this.item.title&&this.item.title.trim();return this.item.menuId>0&&t},captionForm(){return this.item.id?"Редактирование пункта меню":"Добавление пункта меню"}},created(){console.log("ItemEdit created"),null===this.menuItem?this.item.menuId=this.menu.id:this.item={...this.menuItem}},methods:{loadResource(){this.item.docId?(clearTimeout(I),I=setTimeout((()=>{this.$store.clearErrors(),o(s("getResource"),{docId:this.item.docId}).then((t=>{this.item.docTitle=t.payload.resource.docTitle,this.item.url=t.payload.resource.url,this.item.alias=t.payload.resource.alias})).catch((t=>{this.item.docTitle=null,this.item.url=null,this.item.alias=null,this.$defaultError(t)}))}),400)):(this.item.docId=null,this.item.docTitle="",this.item.url="",this.item.alias="")},itemSave(){this.$store.clearErrors(),this.item.docId||(this.item.docId=null),o(s("itemSave"),this.item).then((t=>{this.$emit("itemSave",t.payload.item)})).catch(this.$defaultError)},itemCancel(){this.$emit("cancel")},onPicked(t){this.item.parentId=t.id,this.parentSelectorShow=!1},resetParent(){this.item.parentId=0,this.itemSave()},clearDocId(){this.item.docId=null}},watch:{"item.docId"(t){console.log(t),t||(this.item.replaced=0,this.item.docTitle="",this.item.alias="",this.item.url="")}}},g,[function(){var t=this._self._c;return t("td",[t("span",[this._v("Название пункта")])])},function(){var t=this._self._c;return t("td",[t("span",[this._v("Родитель")])])},function(){var t=this._self._c;return t("td",[t("span",[this._v("Ресурс")])])},function(){var t=this._self._c;return t("td",[t("span",[this._v("Ссылка")])])},function(){var t=this._self._c;return t("td",[t("span",[this._v("Замещаемый элемент")])])},function(){var t=this._self._c;return t("td",[t("span",[this._v("Скрыть этот пункт")])])},function(){var t=this._self._c;return t("td",[t("span",[this._v("MenuID / ItemID")])])},function(){var t=this._self._c;return t("td",[t("span",[this._v("Псевдоним")])])},function(){var t=this._self._c;return t("td",[t("span",[this._v("Пользовательские свойства")])])}],!1,null,null,null);const $=h({components:{ItemEdit:w.exports},props:{menu:{type:Object,default:null}},data:()=>({isEditing:!1,editingItem:null,items:[]}),created(){this.itemList(this.menu.id)},methods:{backToMenuList(){this.$store.setView("MenuList")},itemList(t){this.editingItem=null,this.isEditing=!1,o(s("itemList"),{menuId:t}).then((t=>{this.items=t.payload.itemsTree})).catch(this.$defaultError)},itemCreate(){this.editingItem=null,this.isEditing=!0},itemCancel(){this.isEditing=!1},itemEdit(t){this.editingItem=t,this.isEditing=!0},itemOrder(t,e){o(s("itemOrder"),{id:t.id,parentId:t.parentId,menuId:t.menuId,dir:e}).then((e=>{this.itemList(t.menuId)})).catch(this.$defaultError)},itemDelete(t){confirm("Пункт меню будет удалён со всеми подпунктами!")&&o(s("itemDelete"),{id:t.id}).then((e=>{this.itemList(t.menuId)})).catch(this.$defaultError)},onItemSave(t){this.itemList(t.menuId)}}},b,[function(){var t=this._self._c;return t("h2",{staticClass:"tab selected"},[t("span",[this._v("Редактировать пункты")])])}],!1,null,null,null).exports;var x=function(){var t=this,e=t._self._c;return e("div",[e("a",{staticClass:"node",class:{unpublished:1===t.node.isHide}},[e("span",{staticClass:"indent"},t._l(t.indentArr,(function(t){return e("i")})),0),t._v(" "),e("span",{staticClass:"icon",on:{click:function(e){return e.preventDefault(),t.$emit("change",t.node)}}},[e("i",{staticClass:"fa",class:t.icon})]),t._v(" "),e("span",{staticClass:"title",on:{click:function(e){return e.preventDefault(),t.$emit("change",t.node)}}},[t.node.replaced?t._e():e("span",[t._v(t._s(t.node.title))]),t._v(" "),(t.node.title!==t.node.docTitle||t.node.replaced)&&t.node.docTitle?e("span",{staticClass:"text-muted"},[t._v("("+t._s(t.node.docTitle)+")")]):t._e()]),t._v(" "),e("div",{staticClass:"btn-group"},[e("button",{staticClass:"btn btn-secondary btn-sm",attrs:{disabled:t.disabled||0===t.index},on:{click:function(e){return e.preventDefault(),t.$emit("order",t.node,1)}}},[e("i",{staticClass:"fa fa-arrow-up"})]),t._v(" "),e("button",{staticClass:"btn btn-secondary btn-sm",attrs:{disabled:""}},[t._v(t._s(t.node.orderIndex))]),t._v(" "),e("button",{staticClass:"btn btn-secondary btn-sm",attrs:{disabled:t.disabled||t.index>=t.parentLen-1},on:{click:function(e){return e.preventDefault(),t.$emit("order",t.node,2)}}},[e("i",{staticClass:"fa fa-arrow-down"})]),t._v(" "),e("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{disabled:t.disabled},on:{click:function(e){return e.preventDefault(),t.$emit("delete",t.node)}}},[t._v("Удалить пункт\r\n                ")])])]),t._v(" "),t.node.children.length?e("div",t._l(t.node.children,(function(n,i){return e("TreeNode",{key:n.id,attrs:{disabled:t.disabled,indent:t.indent+1,index:i,node:n,"parent-len":t.node.children.length},on:{change:function(e){return t.$emit("change",e)},delete:function(e){return t.$emit("delete",e)},order:t.onOrder}})})),1):t._e()])};x._withStripped=!0;const D=h({props:{node:{type:Object},index:{type:Number},indent:{type:Number,default:0},parentLen:{type:Number,default:0},disabled:{type:Boolean,default:!1}},data:()=>({}),computed:{icon(){return{"fa-file-o":!this.node.children.length,"fa-folder-open":this.node.children.length&&!this.node.replaced,"fa-exchange":this.node.replaced}},indentArr(){let t=[];for(let e=0;e<this.indent;e++)t.push(1);return t}},methods:{onOrder(t,e){this.$emit("order",t,e)}}},x,[],!1,null,null,null).exports;var S=function(){var t=this,e=t._self._c;return e("div",[e("a",{staticClass:"node",class:t.nodeClasses},[e("span",{staticClass:"indent"},t._l(t.indentArr,(function(t){return e("i")})),0),t._v(" "),e("span",{staticClass:"icon"},[e("i",{staticClass:"fa",class:t.iconClass})]),t._v(" "),e("span",{staticClass:"title",on:{click:function(e){e.preventDefault(),!t.disabledNode&&t.$emit("picked",t.node)}}},[t.node.replaced?e("span",[t._v(t._s(t.node.docTitle))]):e("span",[t._v(t._s(t.node.title))])])]),t._v(" "),t.node.children.length?e("div",t._l(t.node.children,(function(n,i){return e("DocSelectorNode",{key:n.id,attrs:{"current-node":t.currentNode,indent:t.indent+1,node:n},on:{picked:function(e){return t.$emit("picked",e)}}})})),1):t._e()])};S._withStripped=!0;const E=h({props:{node:{type:Object},indent:{type:Number,default:0},currentNode:{type:Object,default:null}},data:()=>({}),computed:{iconClass(){return{"fa-file-o":!this.node.children.length,"fa-folder-open":this.node.children.length&&!this.node.replaced,"fa-exchange":this.node.replaced}},nodeClasses(){return{unpublished:1===this.node.isHide,hidemenu:this.disabledNode}},disabledNode(){return this.node.id===this.currentNode.id||this.node.id===this.currentNode.parentId||1===this.node.replaced},indentArr(){let t=[];for(let e=0;e<this.indent;e++)t.push(1);return t}},methods:{onOrder(t,e){this.$emit("order",t,e)}}},S,[],!1,null,null,null).exports;console.clear(),n().use(m),n().use({install(t){Object.defineProperty(t.prototype,"$defaultError",{get:()=>t=>{t.response?u.addError(t.response.message):(u.addError(t.message),console.error(t))}})}}),n().component("TreeNode",D),n().component("DocSelectorNode",E);const k=["","lightness","light","dark","darkness"];k[parseInt(localStorage.MODX_themeMode)]&&(document.body.classList.remove("lightness"),document.body.classList.remove("light"),document.body.classList.remove("dark"),document.body.classList.remove("darkness"),document.body.classList.add(k[parseInt(localStorage.MODX_themeMode)])),new(n())({el:"#app",components:{MenuList:f,ItemList:$,DocSelector:y},data:{store:u,docSelectorShow:!0},created(){console.log("App created"),d(s("menuList")).then((t=>{this.$store.setMenuList(t.payload.menuList),this.$store.showMenuList()})).catch(this.$defaultError)},mounted(){this.$nextTick((()=>this.$el.classList.add("AppMounted")))},methods:{}})})();